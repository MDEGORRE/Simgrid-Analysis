<html>
    <head>
        <meta charset="UTF-8">
        <title>{% block title %}Résultats d'analyse{% endblock %}</title>
        <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 128 128%22><text y=%221.2em%22 font-size=%2296%22>⚫️</text><text y=%221.3em%22 x=%220.2em%22 font-size=%2276%22 fill=%22%23fff%22>sf</text></svg>">
        {% block stylesheets %}
        <link rel="stylesheet" href="{{asset('assets/css/reset.css')}}"/>
        <link rel="stylesheet" href="{{asset('assets/css/style.css')}}"/>
        {% endblock %}

        {% block javascripts %}
        <script src="assets/javascript/result.js"></script>
        {% endblock %}
    </head>
    <body>
        {% block body %}
        <h1>Résultats d'analyse (qualification et course)</h1>

        <section class='results'>
            <div class='result-quali'>
                <h2>Qualification</h2>

                <table class='result-quali'>
                    <thead>
                        <tr>
                            <th>Position <span id='position-sort-up'>&#8593; </span><span id='position-sort-down'>&#8595;</span></th>
                            <th>Driver</th>
                            <th>Qualification gap</th>
                    </thead>
                    <tbody>
                        {% for key, result in dataQuali %}
                        <tr data-position="{{key}}">
                            <td>{{key}}</td>
                            <td>{{result.driver}}</td>
                            {% if result.gap %}
                            <td>{{result.gap|number_format(2, '.')}} %</td>
                            {% else %}
                            <td>-</td>
                            {% endif %}
                        {% endfor %}
                    </tbody>
                </table>
                <ul class='download-data'>
                    <li><a href="{{ path('download_file_json', {'data': dataQuali}) }}" target='_blank'>Download data as JSON</a></li>
                    <li><a href="{{ path('download_file_csv', {'data': dataQuali}) }}" target='_blank'>Download data as CSV</a></li>
                    <li><a href="{{ path('app_home')}}">Retour à l'accueil</a></li>
                </ul>
            </div>

            <div class='result-race'>
                <h2>Race</h2>

                <p>Lap 1 is ignored.</p>

                <table>
                    <thead>
                        <tr>
                            <th>Position <span id='position-sort-up'>&#8593; </span><span id='position-sort-down'>&#8595;</span></th>
                            <th>Driver</th>
                            <th>Laps</th>
                            <th>Race consistency <span id='consistency-sort-up'>&#8593; </span><span id='consistency-sort-down'>&#8595;</span></th>
                    </thead>
                    <tbody>
                        {% for key, result in dataRace %}
                        <tr data-consistency="{{result.consistency}}" data-position="{{key}}">
                            <td>{{key}}</td>
                            <td>{{result.driver}}</td>
                            <td>{{result.laps}}</td>
                            {% if result.consistency %}
                            <td>{{result.consistency|number_format(2, '.')}} %</td>
                            {% else %}
                            <td>-</td>
                            {% endif %}
                        {% endfor %}
                    </tbody>
                </table>
                <ul>
                    <li><a href="{{ path('download_file_json', {'data': dataRace}) }}" target='_blank'>Download data as JSON</a></li>
                    <li><a href="{{ path('download_file_csv', {'data': dataRace}) }}" target='_blank'>Download data as CSV</a></li>
                    <li><a href="{{ path('app_home')}}">Retour à l'accueil</a></li>
                </ul> 
            </div>

            {% if dataRace2 %}
            <div class='result-race'>
                <h2>Race 2</h2>

                <p>Lap 1 is ignored.</p>

                <table>
                    <thead>
                        <tr>
                            <th>Position <span id='position-sort-up'>&#8593; </span><span id='position-sort-down'>&#8595;</span></th>
                            <th>Driver</th>
                            <th>Laps</th>
                            <th>Race consistency <span id='consistency-sort-up'>&#8593; </span><span id='consistency-sort-down'>&#8595;</span></th>
                    </thead>
                    <tbody>
                        {% for key, result in dataRace2 %}
                        <tr data-consistency="{{result.consistency}}" data-position="{{key}}">
                            <td>{{key}}</td>
                            <td>{{result.driver}}</td>
                            <td>{{result.laps}}</td>
                            {% if result.consistency %}
                            <td>{{result.consistency|number_format(2, '.')}} %</td>
                            {% else %}
                            <td>-</td>
                            {% endif %}
                        {% endfor %}
                    </tbody>
                </table>
                <ul>
                    <li><a href="{{ path('download_file_json', {'data': dataRace2}) }}" target='_blank'>Download data as JSON</a></li>
                    <li><a href="{{ path('download_file_csv', {'data': dataRace2}) }}" target='_blank'>Download data as CSV</a></li>
                    <li><a href="{{ path('app_home')}}">Retour à l'accueil</a></li>
                </ul> 
            </div>
            {% endif %}
        </section>
        {% endblock %}
    </body>
</html>